# NEET Prep AI Platform - Development Rules

## Project Overview
Building India's most comprehensive and intelligent NEET preparation platform that combines 30+ years of historical question data with cutting-edge AI technology to deliver personalized, engaging, and effective learning experiences. Our platform transforms traditional rote learning into an interactive, social, and data-driven journey using a Turbo monorepo architecture with Next.js 15, React Native, TypeScript, Supabase, and the complete Vercel ecosystem.

## Business Objectives (Aligned with PRD v3)
- **Market Leadership**: Capture 10% of the Indian NEET prep market (230,000+ active users) within 24 months
- **Revenue Target**: Achieve ₹15 crores ARR by Year 2 through freemium subscriptions and B2B partnerships
- **Student Impact**: Improve average student scores by 30-50% compared to traditional prep methods
- **Technology Innovation**: Pioneer multimodal AI (voice, vision, AR) in Indian EdTech with mobile-first approach

## Architecture Principles

### Monorepo Structure
```
neet-prep-platform/
├── apps/
│   ├── web/                    # Main Next.js 14 web application
│   ├── mobile/                 # React Native + Expo mobile app
│   ├── admin/                  # Admin dashboard (Next.js)
│   └── coach/                  # Coach portal (Next.js)
├── packages/
│   ├── ui/                     # Shared UI components & design system
│   ├── database/               # Supabase client, types & queries
│   ├── ai/                     # AI services & prompt management
│   ├── auth/                   # Authentication logic & hooks
│   ├── analytics/              # Tracking, metrics & observability
│   ├── config/                 # Shared configurations & constants
│   ├── utils/                  # Common utilities & helpers
│   └── types/                  # Shared TypeScript types
├── tools/
│   ├── eslint-config/          # Shared ESLint configurations
│   └── tailwind-config/        # Shared Tailwind CSS config
└── docs/                       # Documentation & guides
```

## Technology Stack

### Core Technologies (Updated per PRD v3)
- **Framework**: Next.js 15 (App Router, Edge Runtime, Server Components, Streaming)
- **Language**: TypeScript 5.2+ (strict mode enabled)
- **Styling**: Tailwind CSS v4 + Radix UI + Framer Motion
- **Database**: Supabase (PostgreSQL 15 + Auth + Realtime + Storage)
- **Monorepo**: Turborepo
- **Package Manager**: npm workspaces
- **Mobile**: React Native 0.74 + Expo SDK 51
- **State Management**: Zustand + TanStack Query v5
- **Forms**: React Hook Form + Zod validation
- **Animation**: Framer Motion
- **Runtime**: Edge Runtime for serverless functions

### Vercel Platform Services
- **AI SDK**: For AI/ML integration
- **Analytics**: Performance & usage analytics
- **KV**: Redis-compatible storage for caching
- **Blob**: File storage
- **Edge Functions**: Serverless compute
- **Speed Insights**: Performance monitoring

### External Services (Enhanced per PRD v3)
- **Primary LLM**: OpenAI GPT-4o-2024-11-20
- **Specialized AI Models**: 
  - Subject-specific: Fine-tuned Physics, Chemistry, Biology GPT-4o
  - Multilingual: GPT-4o-Hindi for regional language support
  - Emotional Intelligence: Claude-3.5 for emotion-aware interactions
- **Voice AI**: OpenAI Whisper-v3 + ElevenLabs Pro
- **Vision AI**: GPT-4o Vision + Google Vision API
- **ML Platform**: Hugging Face + Custom PyTorch models
- **Vector Database**: Pinecone for semantic search
- **Embeddings**: OpenAI text-embedding-3-large
- **Payments**: Stripe with UPI and digital wallet support
- **Communications**: Twilio (SMS + WhatsApp)
- **Email**: SendGrid + automated sequences
- **Search**: Typesense for advanced search capabilities
- **Monitoring**: Sentry + DataDog + Mixpanel + PostHog

## Target Market & User Personas (PRD v3)

### Primary Persona: Arjun - The Determined Aspirant
- **Demographics**: 17 years old, Class 12 student from Tier-2 city
- **Background**: Middle-class family, household income ₹8-15 lakhs
- **Goals**: Score 650+ in NEET, get admission to government medical college
- **Technology Profile**: Primary smartphone user (Android), 4G/5G connectivity
- **Budget**: ₹3,000-8,000/month for digital learning tools

### Secondary Persona: Priya - The Working Student  
- **Demographics**: 19 years old, gap year student, second NEET attempt
- **Goals**: Improve score from previous 480 to 620+
- **Budget**: ₹2,000-5,000/month for comprehensive preparation tools

### Tertiary Persona: Coach Sharma - The Modern Educator
- **Demographics**: 42 years old, runs coaching institute in Tier-2 city
- **Goals**: Improve student success rates, differentiate institute
- **Budget**: ₹50,000-2,00,000 annually for institutional solutions

## Development Rules

### 1. Code Quality Standards
- **TypeScript**: Always use strict mode (`"strict": true` in tsconfig.json)
- **No `any` types**: Use proper typing or `unknown` if type is truly unknown
- **Explicit return types**: All functions must have explicit return types
- **Const assertions**: Use `as const` for literal types
- **Null checks**: Always handle null/undefined cases explicitly

### 2. File Organization
- **Components**: One component per file, named same as component
- **Barrel exports**: Use index.ts files for clean imports
- **Colocation**: Keep related files together (component + styles + tests)
- **Feature folders**: Group by feature, not by file type

### 3. Naming Conventions
- **Components**: PascalCase (e.g., `QuizEngine.tsx`)
- **Utilities**: camelCase (e.g., `formatDate.ts`)
- **Constants**: UPPER_SNAKE_CASE (e.g., `MAX_RETRY_COUNT`)
- **Types/Interfaces**: PascalCase with descriptive names
- **File names**: kebab-case for non-components (e.g., `quiz-service.ts`)

### 4. API Development
- **Route handlers**: Use Next.js App Router API routes under `app/api/*`
- **Error handling**: Always return proper error responses with status codes
- **Type safety**: Share types between client and server via packages
- **Validation**: Use Zod for runtime validation
- **Rate limiting**: Implement rate limiting using Vercel KV

### 5. Database Guidelines
- **Supabase types**: Generate types using Supabase CLI
- **Row Level Security**: Always implement RLS policies
- **Migrations**: Track all schema changes via migrations
- **Query optimization**: Use proper indexes and avoid N+1 queries
- **Transactions**: Use database transactions for multi-step operations

### 6. Component Guidelines
- **Server Components**: Default to Server Components, use Client Components only when needed
- **Suspense boundaries**: Implement proper loading states
- **Error boundaries**: Wrap features in error boundaries
- **Accessibility**: Follow WCAG 2.1 AA standards
- **Responsive design**: Mobile-first approach

### 7. Testing Requirements
- **Unit tests**: For utilities and pure functions
- **Integration tests**: For API routes
- **E2E tests**: For critical user flows
- **Test coverage**: Minimum 70% coverage
- **Test naming**: Use descriptive test names that explain the scenario

### 8. Performance Rules
- **Bundle size**: Monitor and optimize bundle sizes
- **Code splitting**: Implement dynamic imports for large features
- **Image optimization**: Use Next.js Image component
- **Caching**: Implement proper caching strategies with Vercel KV
- **Database queries**: Optimize queries, use pagination

### 9. Security Standards
- **Authentication**: Use Supabase Auth with proper session management
- **Authorization**: Implement role-based access control (RBAC)
- **Input validation**: Always validate and sanitize user input
- **Secrets management**: Never commit secrets, use environment variables
- **CORS**: Configure proper CORS policies
- **Rate limiting**: Implement rate limiting on all API endpoints

### 10. Git Workflow
- **Branch naming**: `feature/description`, `fix/description`, `chore/description`
- **Commit messages**: Use conventional commits (e.g., `feat:`, `fix:`, `docs:`)
- **PR size**: Keep PRs small and focused (max 400 lines changed)
- **Code review**: All code must be reviewed before merging
- **CI/CD**: All tests must pass before merging

## Environment Variables

### Required Variables
```bash
# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# OpenAI
OPENAI_API_KEY=

# Vercel KV
KV_REST_API_URL=
KV_REST_API_TOKEN=

# Stripe
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# Twilio
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# SendGrid
SENDGRID_API_KEY=
```

### Development Setup
1. Copy `.env.example` to `.env.local`
2. Never commit `.env.local` or any file with real secrets
3. Use different env vars for development, staging, and production

## Build & Deployment

### Development Commands
```bash
# Install dependencies
npm install

# Start development servers
npm run dev

# Build all apps and packages
npm run build

# Run tests
npm run test

# Lint code
npm run lint

# Type check
npm run type-check

# Generate Supabase types
npm run db:generate

# Run database migrations
npm run db:migrate
```

### Deployment Process
1. **Staging**: Automatic deployment on push to `develop` branch
2. **Production**: Manual deployment after approval on `main` branch
3. **Preview**: Automatic preview deployments for all PRs
4. **Rollback**: Use Vercel dashboard for instant rollbacks

## AI Integration Guidelines (Enhanced per PRD v3)

### Multi-Model Architecture
- **Primary LLM**: GPT-4o-2024-11-20 for general interactions
- **Subject Specialists**: Fine-tuned models for Physics, Chemistry, Biology
- **Cultural Intelligence**: AI trained on Indian educational context and cultural references
- **Emotional Intelligence**: AI that recognizes and responds to student emotional states
- **Model Router**: Intelligent routing to appropriate specialized models

### Advanced AI Features (PRD v3 Requirements)
- **Hyperpersonalization**: Every student gets unique learning journey based on performance, learning style, and emotional state
- **Predictive NEET Score**: AI forecasts final NEET score with 85%+ accuracy
- **Voice AI Tutor ("NEET Buddy 3.0")**: Conversational AI supporting 8 Indian languages
- **AR Question Scanner with Battle Mode**: Gamified competitive problem-solving
- **Emotional Learning Intelligence**: AI detects stress, motivation levels, and optimizes learning

### Prompt Engineering
- Keep prompts focused and specific
- Include relevant context about student level, cultural background, and learning style
- Use structured output formats (JSON when possible) with Zod validation
- Implement prompt versioning for A/B testing
- Monitor token usage and costs (target <₹50 per student per month)
- Support code-switching between English and Hindi in conversations

### AI Service Rules
- **Caching**: Cache AI responses in Vercel KV (24hr TTL for explanations, 7-day for study plans)
- **Rate limiting**: Implement per-user rate limits (Free: 10 AI interactions/day, Premium: Unlimited)
- **Fallbacks**: Always have fallback behavior if AI fails (cached responses, simplified interactions)
- **Streaming**: Use streaming for long responses (explanations, study plans)
- **Error handling**: Graceful degradation when AI services are unavailable
- **Cost Management**: Real-time cost monitoring with automatic circuit breakers
- **Bias Detection**: Regular bias audits using fairness metrics for diverse Indian student population

## Package Dependencies

### Adding Dependencies
- **Workspace packages**: Use `npm install package-name -w packages/package-name`
- **App dependencies**: Use `npm install package-name -w apps/app-name`
- **Root dependencies**: Only for build tools and dev dependencies
- **Version pinning**: Pin exact versions for critical dependencies

### Package Rules
- **No circular dependencies**: Packages cannot depend on each other circularly
- **Explicit exports**: All packages must have explicit exports in package.json
- **Type exports**: Always export TypeScript types alongside implementations
- **Documentation**: Each package must have its own README.md

## Monitoring & Observability

### Required Monitoring
- **Error tracking**: Sentry for error monitoring
- **Performance**: Vercel Analytics and Speed Insights
- **Uptime**: Use Vercel's built-in monitoring
- **Database**: Monitor query performance via Supabase dashboard
- **AI usage**: Track token usage and costs

### Logging Standards
- **Structured logging**: Use JSON format for logs
- **Log levels**: Use appropriate levels (error, warn, info, debug)
- **Sensitive data**: Never log passwords, tokens, or PII
- **Correlation IDs**: Include request IDs for tracing

## Mobile App Specific Rules

### React Native Guidelines
- **Expo managed workflow**: Use Expo for easier deployment
- **Platform-specific code**: Minimize platform-specific implementations
- **Navigation**: Use React Navigation v6
- **State management**: Share Zustand stores with web where possible
- **Offline support**: Implement offline-first features with AsyncStorage

## Documentation Requirements

### Code Documentation
- **JSDoc comments**: For all public APIs and complex functions
- **README files**: Each package and app must have a README
- **API documentation**: Use OpenAPI/Swagger for API docs
- **Architecture Decision Records**: Document significant decisions

## Performance Targets

### Web Vitals
- **LCP**: < 2.5 seconds
- **FID**: < 100 milliseconds
- **CLS**: < 0.1
- **TTFB**: < 600 milliseconds

### API Performance
- **Response time**: < 200ms for cached, < 1s for computed
- **Throughput**: Handle 1000+ concurrent users
- **Error rate**: < 0.1% error rate

## Monetization Strategy (PRD v3 Aligned)

### Freemium Model
```typescript
interface FreemiumTiers {
  free: {
    practiceQuestions: 100; // per day
    mockTests: 2; // per month
    aiExplanations: 10; // per day
    voiceInteractions: 15; // minutes per day
    studyGroups: 3; // maximum concurrent memberships
    previousYearPapers: 'last_3_years';
  };
  
  premium: {
    monthlyPrice: 199; // INR - competitive with market
    yearlyPrice: 1999; // INR (17% discount)
    features: [
      'Unlimited practice questions',
      'Unlimited AI explanations',
      'Advanced Voice AI (60 min/day)',
      'AR Scanner features',
      'Predictive analytics',
      'Parent dashboard'
    ];
  };
  
  premiumPlus: {
    monthlyPrice: 399; // INR
    yearlyPrice: 3999; // INR
    features: [
      'One-on-one mentorship (2 hours/month)',
      'Expert doubt clearing',
      'Custom content generation',
      'Biometric wellness tracking',
      'Career guidance sessions'
    ];
  };
}
```

### Revenue Targets (PRD v3)
- **Year 1**: ₹3.4 crores total revenue (50K users, 20% premium conversion)
- **Year 2**: ₹11.3 crores total revenue (150K users, 25% premium conversion)  
- **Year 3**: ₹25.5 crores total revenue (300K users, 30% premium conversion)

### B2B Revenue Streams
- **Coaching Institute White-label**: ₹5L setup + ₹99/student/month
- **School Integration**: ₹2L annual license for unlimited students
- **API Licensing**: ₹50K/month for question bank and AI tutoring APIs

## Performance Targets (PRD v3)

### Technical Performance
- **API Latency**: <100ms (95th percentile)
- **Page Load Time**: <1.5s (First Contentful Paint)
- **Concurrent Users**: 100,000+ simultaneous users
- **Availability**: 99.99% uptime
- **Mobile Performance**: <2s app startup time

### Educational Outcomes
- **Score Improvement**: 40% average improvement in mock test scores within 3 months
- **NEET Score Prediction**: 90% accuracy within ±25 points
- **Weak Area Reduction**: 50% improvement in identified weak topics
- **Student Engagement**: 75+ minutes average session time
- **Retention Rates**: 90% monthly retention for premium users

## Development Phases (Updated per PRD v3)

### Phase 1: Foundation (Months 1-3) ✅ Current
- Monorepo setup with enhanced architecture
- Core packages with advanced typing
- 15,000 NEET questions with rich metadata
- Basic AI integration (GPT-4o explanations)
- Mobile-first PWA with offline capabilities

### Phase 2: AI Enhancement (Months 4-6)
- Voice AI tutor with 8 language support
- AR question scanner with battle mode
- Predictive analytics (85%+ accuracy)
- Advanced study group formation
- Parent dashboard with real-time insights

### Phase 3: Market Expansion (Months 7-9)
- B2B features (coaching portal, white-label)
- Regional language UI/UX (8 Indian languages)
- Advanced personalization engine
- Biometric integration (optional)
- Local payment methods (UPI, wallets)

### Phase 4: Scale & Optimization (Months 10-12)
- Support for 100,000+ concurrent users
- Sub-100ms API response times
- VR learning modules
- International expansion (Southeast Asia)
- Advanced biometrics (eye tracking)

## Contact & Support

For questions about these rules or the project architecture, consult the design document: `NEET Prep AI Platform - Comprehensive System Design.md`

---

**Remember**: 
- Always prioritize type safety and code quality
- Keep the codebase maintainable and scalable
- Follow the established patterns consistently
- Document your decisions and changes
- Test your code thoroughly before committing
